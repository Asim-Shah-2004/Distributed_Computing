# Static Load Balancing Configuration (Round-Robin)
upstream static_backend {
    server app1:3000;
    server app2:3000;
    server app3:3000;
    # Round-robin is the default algorithm, no need to specify
}

server {
    listen 80;
    server_name static.example.com;

    location / {
        proxy_pass http://static_backend;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        
        # Add header to identify which load balancing method was used
        add_header X-Load-Balancing-Method "Static (Round-Robin)" always;
    }
}

# IP Hash Static Load Balancing (session persistence)
upstream static_iphash_backend {
    ip_hash;  # This ensures the same client always reaches the same server
    server app1:3000;
    server app2:3000;
    server app3:3000;
}

server {
    listen 80;
    server_name static-iphash.example.com;

    location / {
        proxy_pass http://static_iphash_backend;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        
        # Add header to identify which load balancing method was used
        add_header X-Load-Balancing-Method "Static (IP Hash)" always;
    }
}